<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <link rel="icon" href="/New_Attendance-System/0rigin.svg" type="image/x-icon">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title data-i18n="APP_TITLE">APP_TITLE</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                darkMode: 'class',
                theme: {
                    extend: {}
                }
            }
            document.addEventListener('DOMContentLoaded', () => {
                const toggleButton = document.getElementById('theme-toggle');
                const htmlElement = document.documentElement;
                const themeIcon = document.getElementById('theme-icon');
                
                function updateThemeIcon() {
                    if (htmlElement.classList.contains('dark')) {
                        themeIcon.textContent = '☀️';
                    } else {
                        themeIcon.textContent = '🌙';
                    }
                }
                
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    htmlElement.classList.add('dark');
                } else {
                    htmlElement.classList.remove('dark');
                }
                
                updateThemeIcon();
                
                toggleButton.addEventListener('click', () => {
                    htmlElement.classList.toggle('dark');
                    
                    if (htmlElement.classList.contains('dark')) {
                        localStorage.setItem('theme', 'dark');
                    } else {
                        localStorage.setItem('theme', 'light');
                    }
                    
                    updateThemeIcon();
                });
            });
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <!-- 使用新的 CSS 設計 -->
        <link rel="stylesheet" href="style-redesign.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
       
        <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
        <style>
            input[type="date"]::-webkit-calendar-picker-indicator,
            input[type="time"]::-webkit-calendar-picker-indicator {
                filter: var(--date-picker-filter, none);
            }

            .dark input[type="date"]::-webkit-calendar-picker-indicator,
            .dark input[type="time"]::-webkit-calendar-picker-indicator {
                --date-picker-filter: invert(1);
            }

            select option {
                background-color: white;
                color: black;
            }

            .dark select option {
                background-color: #374151;
                color: white;
            }
        </style>
    </head>
    <body class="flex items-center justify-center min-h-screen p-4">
        <div id="app-container" class="w-full max-w-md mx-auto">
            <!-- User Profile & Header -->
            <header id="user-header" class="flex items-center justify-between p-4 mb-6 card fade-in" style="display: none;">
                
                <div class="flex items-center space-x-3">
                    <img id="profile-img" src="https://placehold.co/40x40/e0e0e0/757575?text=U" alt="頭像" class="w-10 h-10 rounded-full">
                    <div>
                        <p id="user-name" class="font-semibold">使用者名稱</p>
                        <p id="welcome-mes" data-i18n="WELCOME_BACK" class="text-xs text-gray-500 dark:text-gray-400">歡迎回來！</p>
                    </div>
                </div>
                
                <div class="flex flex-col items-end space-y-2">
                    
                    <div class="flex items-center space-x-3">
                        <button id="logout-btn" data-i18n="BTN_LOGOUT" class="text-sm font-medium text-gray-600 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-400">登出</button>
                        <button id="theme-toggle"
                            class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                            <span id="theme-icon">[暗]</span>
                        </button>
                    </div>
                    <select id="language-switcher" class="text-sm font-medium text-gray-600 rounded-md p-1 dark:text-gray-300 dark:bg-gray-700 max-w-xs">
                        <option value="zh-TW">繁體中文</option>
                        <option value="en-US">English</option>
                        <option value="id">Bahasa Indonesia</option>
                        <option value="vi">Tiếng Việt</option>
                        <option value="ja">日本語</option>
                        <option value="ko">한국어</option>
                    </select>
                    
                </div>
                
            </header>
            
            <!-- Login Section -->
            <section id="login-section" class="text-center p-8 card fade-in">
                <img src="/New_Attendance-System/0rigin.svg" alt="打卡系統橫幅圖" class="main-image">
                <h1 id="appTitle" data-i18n="SUBTITLE_LOGIN" class="text-2xl font-bold text-gray-800 mb-2 dark:text-white">歡迎打卡救星</h1>
                <p class="text-gray-600 dark:text-gray-400 mb-6" data-i18n="LOGIN_INFO" id="status">請點擊登入以繼續。</p>
                <div id="login" class="space-y-4">
                    <button id="login-btn" data-i18n="BTN_LOGOIN" class="w-full py-3 px-4 rounded-lg font-bold btn-primary" style="display: none;">使用LINE登入</button>
                </div>
            </section>
            
            <!-- Main App Content -->
            <div id="main-app" class="fade-in" style="display: none;">
                <!-- Tab Navigation -->
                <div class="flex justify-center space-x-2 mb-6 flex-wrap gap-y-2">
                    <button id="tab-dashboard-btn" data-i18n="TAB_DASHBOARD" class="py-2 px-4 rounded-full font-bold text-sm text-white bg-indigo-600 dark:bg-indigo-500">儀表板</button>
                    <button id="tab-monthly-btn" data-i18n="TAB_MONTHLY" class="py-2 px-4 rounded-full font-bold text-sm text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-700">出勤記錄</button>
                    <button id="tab-location-btn" data-i18n="TAB_LOCATION" class="py-2 px-4 rounded-full font-bold text-sm text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-700">定位</button>
                    <!-- 👇 排班按鈕 (新增) -->
                    <button id="tab-shift-btn" data-i18n="TAB_SHIFT" class="py-2 px-4 rounded-full font-bold text-sm text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-700">排班</button>
                    <!-- 👇 加班按鈕 -->
                    <button id="tab-overtime-btn" data-i18n="TAB_OVERTIME" class="py-2 px-4 rounded-full font-bold text-sm text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-700">加班</button>
                    <!-- 👇 請假按鈕 -->
                    <button id="tab-leave-btn" data-i18n="TAB_LEAVE" class="py-2 px-4 rounded-full font-bold text-sm text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-700">請假</button>
                    <button id="tab-admin-btn" data-i18n="TAB_ADMIN" class="py-2 px-4 rounded-full font-bold text-sm text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-700" style="display: none;">管理</button>
                </div>
                
                <!-- Dashboard Tab -->
                <section id="dashboard-view" class="active">
                    <div class="card p-6">
                        <h2 data-i18n="PUNCH_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">快速打卡</h2>
                        <p data-i18n="PUNCH_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">點擊下方按鈕進行打卡。</p>
                        <div class="space-y-4">
                            <button data-i18n="PUNCH_IN_BTN" id="punch-in-btn" class="w-full py-3 px-4 rounded-lg font-bold btn-primary">上班打卡</button>
                            <button data-i18n="PUNCH_OUT_BTN" id="punch-out-btn" class="w-full py-3 px-4 rounded-lg font-bold btn-warning">下班打卡</button>
                            
                        </div>
                        <div id="punch-result" class="mt-4 text-center"></div>
                    </div>
                    
                    <!-- 新增：使用者資訊卡片 - 移除 emoji -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="USER_INFO_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-4">個人資訊</h2>
                        
                        <!-- 資訊網格 -->
                        <div class="info-grid">
                            <!-- 部門卡片 -->
                            <div class="info-card">
                                <div class="info-label" data-i18n="USER_DEPT_LABEL">部門</div>
                                <div class="info-value" id="user-dept">--</div>
                            </div>
                            
                            <!-- 職位卡片 -->
                            <div class="info-card">
                                <div class="info-label" data-i18n="USER_POSITION_LABEL">職位</div>
                                <div class="info-value" id="user-position">--</div>
                            </div>
                            
                            <!-- 月薪卡片 - 移除 emoji，使用簡潔設計 -->
                            <div class="info-card salary-card">
                                <div class="info-label salary-label" data-i18n="USER_SALARY_LABEL">月薪</div>
                                <div class="info-value" id="user-salary">--</div>
                            </div>
                            
                            <!-- 時薪卡片 - 移除 emoji，使用簡潔設計 -->
                            <div class="info-card salary-card">
                                <div class="info-label salary-label" data-i18n="USER_HOURLY_SALARY_LABEL">時薪</div>
                                <div class="info-value" id="user-hourly-salary">--</div>
                            </div>
                        </div>
                    </div>

                    <!-- 今日排班資訊 -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="TODAY_SHIFT_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-4">今日排班</h2>
                        
                        <div id="today-shift-loading" class="text-center text-gray-500 dark:text-gray-400 py-4">
                            <div class="loading-spinner mx-auto mb-2"></div>
                            <p data-i18n="LOADING">載入中...</p>
                        </div>
                        
                        <div id="today-shift-empty" class="text-center text-gray-500 dark:text-gray-400 py-4" style="display: none;">
                            <p data-i18n="TODAY_NO_SHIFT">今日無排班</p>
                        </div>
                        
                        <div id="today-shift-info" style="display: none;">
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400" data-i18n="SHIFT_TYPE_LABEL">班別</span>
                                    <span class="font-semibold text-purple-900 dark:text-purple-200" id="shift-type">--</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400" data-i18n="SHIFT_TIME_LABEL">時間</span>
                                    <span class="font-semibold text-purple-900 dark:text-purple-200" id="shift-time">--</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400" data-i18n="SHIFT_LOCATION_LABEL">地點</span>
                                    <span class="font-semibold text-purple-900 dark:text-purple-200" id="shift-location">--</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 本週排班 -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="WEEK_SHIFT_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-4">本週排班</h2>
                        
                        <div id="week-shift-loading" class="text-center text-gray-500 dark:text-gray-400 py-4">
                            <div class="loading-spinner mx-auto mb-2"></div>
                            <p data-i18n="LOADING">載入中...</p>
                        </div>
                        
                        <div id="week-shift-empty" class="text-center text-gray-500 dark:text-gray-400 py-4" style="display: none;">
                            <p data-i18n="WEEK_NO_SHIFT">本週無排班</p>
                        </div>
                        
                        <div id="week-shift-list" class="space-y-2"></div>
                    </div>
                    
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="TODAY_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">今日打卡記錄</h2>
                        <p data-i18n="TODAY_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">查看您今天的打卡記錄。</p>
                        <div id="today-records" class="space-y-2">
                            <p data-i18n="TODAY_NO_RECORDS" class="text-gray-500 dark:text-gray-400 text-center py-4">今日尚無打卡記錄。</p>
                        </div>
                    </div>
                </section>
                
                <!-- Monthly Tab -->
                <section id="monthly-view" style="display: none;">
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h2 data-i18n="MONTHLY_TITLE" class="text-xl font-bold text-gray-800 dark:text-white">月曆檢視</h2>
                            <button data-i18n="EXPORT_REPORT_BTN" id="export-attendance-btn" class="py-2 px-4 rounded-lg font-bold btn-primary text-sm">匯出報表</button>
                        </div>
                        <div class="flex items-center justify-between mb-4">
                            <button id="prev-month" class="py-2 px-4 rounded-lg font-bold btn-secondary">◀</button>
                            <h3 id="current-month" class="text-lg font-bold text-gray-800 dark:text-white">2024年10月</h3>
                            <button id="next-month" class="py-2 px-4 rounded-lg font-bold btn-secondary">▶</button>
                        </div>
                        <div id="loading" class="text-center text-gray-500 dark:text-gray-400" style="display: none;">
                            <div class="loading-spinner mx-auto mb-2"></div>
                            <p data-i18n="LOADING">載入中...</p>
                        </div>
                        <div id="calendar-grid" class="calendar-grid"></div>
                    </div>
                    
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="DAILY_TITLE" id="daily-records-title" class="text-xl font-bold text-gray-800 dark:text-white mb-2">每日詳細</h2>
                        <div id="daily-records" class="space-y-2">
                            <p data-i18n="DAILY_SELECT_DATE" class="text-gray-500 dark:text-gray-400 text-center py-4">請選擇日期以查看詳細資訊。</p>
                        </div>
                    </div>
                </section>
                
                <!-- Location Tab -->
                <section id="location-view" style="display: none;">
                    <div class="card p-6">
                        <h2 data-i18n="LOCATION_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">定位地圖</h2>
                        <p data-i18n="LOCATION_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">查看當前位置和可用打卡地點。</p>
                        <div id="map" style="width: 100%; height: 400px;" class="rounded-lg"></div>
                    </div>
                </section>

                <!-- 排班分頁 -->
                <section id="shift-view" style="display: none;">
                    <div class="card p-6">
                        <h2 data-i18n="SHIFT_VIEW_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-4">排班查詢</h2>
                        
                        <!-- 今日排班 -->
                        <div class="mb-6">
                            <h3 data-i18n="TODAY_SHIFT_TITLE" class="text-lg font-semibold text-gray-700 dark:text-gray-300 mb-3">今日排班</h3>
                            
                            <div id="today-shift-loading-2" class="text-center text-gray-500 dark:text-gray-400 py-4">
                                <div class="loading-spinner mx-auto mb-2"></div>
                                <p data-i18n="LOADING">載入中...</p>
                            </div>
                            
                            <div id="today-shift-empty-2" class="text-center text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-4 rounded-lg" style="display: none;">
                                <p data-i18n="TODAY_NO_SHIFT">今日無排班</p>
                            </div>
                            
                            <div id="today-shift-info-2" class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg" style="display: none;">
                                <div class="space-y-2">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600 dark:text-gray-400" data-i18n="SHIFT_TYPE_LABEL">班別</span>
                                        <span class="font-semibold text-purple-900 dark:text-purple-200" id="shift-type-2">--</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600 dark:text-gray-400" data-i18n="SHIFT_TIME_LABEL">時間</span>
                                        <span class="font-semibold text-purple-900 dark:text-purple-200" id="shift-time-2">--</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600 dark:text-gray-400" data-i18n="SHIFT_LOCATION_LABEL">地點</span>
                                        <span class="font-semibold text-purple-900 dark:text-purple-200" id="shift-location-2">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 本週排班 -->
                        <div>
                            <h3 data-i18n="WEEK_SHIFT_TITLE" class="text-lg font-semibold text-gray-700 dark:text-gray-300 mb-3">本週排班</h3>
                            
                            <div id="week-shift-loading-2" class="text-center text-gray-500 dark:text-gray-400 py-4">
                                <div class="loading-spinner mx-auto mb-2"></div>
                                <p data-i18n="LOADING">載入中...</p>
                            </div>
                            
                            <div id="week-shift-empty-2" class="text-center text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-4 rounded-lg" style="display: none;">
                                <p data-i18n="WEEK_NO_SHIFT">本週無排班</p>
                            </div>
                            
                            <div id="week-shift-list-2" class="space-y-2"></div>
                        </div>
                    </div>
                </section>

                <!-- 加班分頁 -->
                <section id="overtime-view" style="display: none;">
                    <div class="card p-6">
                        <h2 data-i18n="OVERTIME_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">加班申請</h2>
                        <p data-i18n="OVERTIME_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">提交您的加班申請</p>
                        
                        <form id="overtime-form" class="space-y-4">
                            <div>
                                <label data-i18n="OVERTIME_DATE_LABEL" for="overtime-date" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">加班日期</label>
                                <input type="date" id="overtime-date" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label data-i18n="OVERTIME_START_LABEL" for="overtime-start" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">開始時間</label>
                                <input type="time" id="overtime-start" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label data-i18n="OVERTIME_END_LABEL" for="overtime-end" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">結束時間</label>
                                <input type="time" id="overtime-end" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label data-i18n="OVERTIME_REASON_LABEL" for="overtime-reason" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">加班原因</label>
                                <textarea id="overtime-reason" rows="3" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"></textarea>
                            </div>
                            
                            <button data-i18n="OVERTIME_SUBMIT_BTN" type="submit" class="w-full py-3 px-4 rounded-lg font-bold btn-primary">提交申請</button>
                        </form>
                    </div>
                    
                    <!-- 我的加班記錄 -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="MY_OVERTIME_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-4">我的加班記錄</h2>
                        
                        <div id="my-overtime-loading" class="text-center text-gray-500 dark:text-gray-400 py-4">
                            <div class="loading-spinner mx-auto mb-2"></div>
                            <p data-i18n="LOADING">載入中...</p>
                        </div>
                        
                        <div id="my-overtime-empty" class="text-center text-gray-500 dark:text-gray-400 py-4" style="display: none;">
                            <p data-i18n="OVERTIME_NO_RECORDS">尚無加班記錄</p>
                        </div>
                        
                        <ul id="my-overtime-list" class="space-y-3"></ul>
                    </div>
                </section>

                <!-- 請假分頁 -->
                <section id="leave-view" style="display: none;">
                    <div class="card p-6">
                        <h2 data-i18n="LEAVE_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">請假申請</h2>
                        <p data-i18n="LEAVE_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">提交您的請假申請</p>
                        
                        <form id="leave-form" class="space-y-4">
                            <div>
                                <label data-i18n="LEAVE_TYPE_LABEL" for="leave-type" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">假別</label>
                                <select id="leave-type" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                    <option value="" data-i18n="LEAVE_TYPE_SELECT">請選擇假別</option>
                                    <option value="事假" data-i18n="LEAVE_TYPE_PERSONAL">事假</option>
                                    <option value="病假" data-i18n="LEAVE_TYPE_SICK">病假</option>
                                    <option value="特休" data-i18n="LEAVE_TYPE_ANNUAL">特休</option>
                                    <option value="婚假" data-i18n="LEAVE_TYPE_MARRIAGE">婚假</option>
                                    <option value="喪假" data-i18n="LEAVE_TYPE_BEREAVEMENT">喪假</option>
                                    <option value="其他" data-i18n="LEAVE_TYPE_OTHER">其他</option>
                                </select>
                            </div>
                            
                            <div>
                                <label data-i18n="LEAVE_START_LABEL" for="leave-start" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">開始日期</label>
                                <input type="date" id="leave-start" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label data-i18n="LEAVE_END_LABEL" for="leave-end" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">結束日期</label>
                                <input type="date" id="leave-end" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label data-i18n="LEAVE_REASON_LABEL" for="leave-reason" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">請假原因</label>
                                <textarea id="leave-reason" rows="3" required 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"></textarea>
                            </div>
                            
                            <button data-i18n="LEAVE_SUBMIT_BTN" type="submit" class="w-full py-3 px-4 rounded-lg font-bold btn-primary">提交申請</button>
                        </form>
                    </div>
                    
                    <!-- 我的請假記錄 -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="MY_LEAVE_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-4">我的請假記錄</h2>
                        
                        <div id="my-leave-loading" class="text-center text-gray-500 dark:text-gray-400 py-4">
                            <div class="loading-spinner mx-auto mb-2"></div>
                            <p data-i18n="LOADING">載入中...</p>
                        </div>
                        
                        <div id="my-leave-empty" class="text-center text-gray-500 dark:text-gray-400 py-4" style="display: none;">
                            <p data-i18n="LEAVE_NO_RECORDS">尚無請假記錄</p>
                        </div>
                        
                        <ul id="my-leave-list" class="space-y-3"></ul>
                    </div>
                </section>
                
                <!-- Admin Tab -->
                <section id="admin-view" style="display: none;">
                    <div class="card p-6">
                        <h2 data-i18n="VIRTUAL_PUNCH_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">虛擬打卡</h2>
                        <p data-i18n="VIRTUAL_PUNCH_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">手動為員工新增打卡記錄。</p>
                        <div class="space-y-4">
                            <div>
                                <label data-i18n="EMPLOYEE_ID_LABEL" for="virtual-employee-id" class="block text-sm font-medium text-gray-700 dark:text-gray-300">員工 ID</label>
                                <input type="text" id="virtual-employee-id" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                            </div>
                            <div>
                                <label data-i18n="PUNCH_TYPE_LABEL" for="virtual-punch-type" class="block text-sm font-medium text-gray-700 dark:text-gray-300">打卡類型</label>
                                <select id="virtual-punch-type" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                                    <option value="上班" data-i18n="PUNCH_IN_OPTION">上班</option>
                                    <option value="下班" data-i18n="PUNCH_OUT_OPTION">下班</option>
                                </select>
                            </div>
                            <div>
                                <label data-i18n="PUNCH_DATE_LABEL" for="virtual-punch-date" class="block text-sm font-medium text-gray-700 dark:text-gray-300">打卡日期</label>
                                <input type="date" id="virtual-punch-date" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                            </div>
                            <div>
                                <label data-i18n="PUNCH_TIME_LABEL" for="virtual-punch-time" class="block text-sm font-medium text-gray-700 dark:text-gray-300">打卡時間</label>
                                <input type="time" id="virtual-punch-time" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                            </div>
                            <div>
                                <label data-i18n="PUNCH_NOTE_LABEL" for="virtual-punch-note" class="block text-sm font-medium text-gray-700 dark:text-gray-300">備註</label>
                                <input type="text" id="virtual-punch-note" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                            </div>
                            <button data-i18n="SUBMIT_VIRTUAL_PUNCH_BTN" id="submit-virtual-punch-btn" class="w-full py-2 px-4 rounded-lg font-bold btn-primary">提交虛擬打卡</button>
                        </div>
                    </div>
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="PENDING_REQUESTS_TITLE" 
                            class="text-xl font-bold text-gray-800 dark:text-white mb-2">
                            待審核請求
                        </h2>
                        <p data-i18n="PENDING_REQUESTS_DESCRIPTION" 
                           class="text-gray-500 dark:text-gray-400 mb-4">
                            審核員工提出的虛擬打卡申請。
                        </p>
                        
                        <div id="pending-requests-container">
                            <div id="requests-loading" 
                                 data-i18n="REQUESTS_LOADING" 
                                 class="text-center text-gray-500 dark:text-gray-400 py-4">
                                正在載入請求...
                            </div>
                            <div id="requests-empty" 
                                 class="text-center text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/30 p-4 rounded-lg" 
                                 style="display: none;">
                                <p data-i18n="REQUESTS_EMPTY" 
                                   class="font-semibold">
                                    太棒了！目前沒有待審核的請求。
                                </p>
                            </div>
                            <ul id="pending-requests-list" class="space-y-3"></ul>
                        </div>
                    </div>
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="ADMIN_EXPORT_TITLE" 
                            class="text-xl font-bold text-gray-800 dark:text-white mb-2">
                            匯出報表
                        </h2>
                        <p data-i18n="ADMIN_EXPORT_DESCRIPTION" 
                        class="text-gray-500 dark:text-gray-400 mb-4">
                            匯出所有員工的出勤報表
                        </p>
                        
                        <div class="space-y-4">
                            <!-- 選擇月份 -->
                            <div>
                                <label data-i18n="ADMIN_EXPORT_MONTH_LABEL" 
                                    for="admin-export-month" 
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    選擇月份
                                </label>
                                <input type="month" 
                                    id="admin-export-month" 
                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm dark:bg-gray-700 dark:text-white focus:ring-indigo-500 focus:border-indigo-500">
                            </div>
                            
                            <!-- 匯出按鈕 -->
                            <button id="admin-export-all-btn" 
                                    data-i18n="ADMIN_EXPORT_ALL_BTN"
                                    class="w-full py-3 px-4 rounded-lg font-bold btn-primary">
                                    匯出所有員工報表
                            </button>
                        </div>
                    </div>
                    <!-- 👇 加班審核區塊 -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="OVERTIME_PENDING_TITLE" 
                            class="text-xl font-bold text-gray-800 dark:text-white mb-2">
                            待審核加班申請
                        </h2>
                        <p data-i18n="OVERTIME_PENDING_DESCRIPTION" 
                           class="text-gray-500 dark:text-gray-400 mb-4">
                            審核員工提出的加班申請
                        </p>
                        
                        <div id="pending-overtime-container">
                            <div id="overtime-requests-loading" 
                                 data-i18n="REQUESTS_LOADING" 
                                 class="text-center text-gray-500 dark:text-gray-400 py-4">
                                正在載入請求...
                            </div>
                            <div id="overtime-requests-empty" 
                                 class="text-center text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/30 p-4 rounded-lg" 
                                 style="display: none;">
                                <p data-i18n="OVERTIME_NO_PENDING" 
                                   class="font-semibold">
                                    太棒了！目前沒有待審核的加班申請。
                                </p>
                            </div>
                            <ul id="pending-overtime-list" class="space-y-3"></ul>
                        </div>
                    </div>
                    
                    <!-- 👇 請假審核區塊 -->
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="LEAVE_PENDING_TITLE" 
                            class="text-xl font-bold text-gray-800 dark:text-white mb-2">
                            待審核請假申請
                        </h2>
                        <p data-i18n="LEAVE_PENDING_DESCRIPTION" 
                           class="text-gray-500 dark:text-gray-400 mb-4">
                            審核員工提出的請假申請
                        </p>
                        
                        <div id="pending-leave-container">
                            <div id="leave-requests-loading" 
                                 data-i18n="REQUESTS_LOADING" 
                                 class="text-center text-gray-500 dark:text-gray-400 py-4">
                                正在載入請求...
                            </div>
                            <div id="leave-requests-empty" 
                                 class="text-center text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/30 p-4 rounded-lg" 
                                 style="display: none;">
                                <p data-i18n="LEAVE_NO_PENDING" 
                                   class="font-semibold">
                                    太棒了！目前沒有待審核的請假申請。
                                </p>
                            </div>
                            <ul id="pending-leave-list" class="space-y-3"></ul>
                        </div>
                    </div>
                    
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="ADD_LOCATION_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">新增打卡地點</h2>
                        <p data-i18n="ADD_LOCATION_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">輸入地點名稱,並使用您的當前位置作為經緯度。</p>
                        <div class="space-y-4">
                            <div>
                                <label data-i18n="LOCATION_NAME_LABEL" for="location-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">地點名稱</label>
                                <input type="text" id="location-name" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                            </div>
                            <div>
                                <label data-i18n="COORDINATES_LAT_LNG_LABEL" class="block text-sm font-medium text-gray-700 dark:text-gray-300">經緯度 (Latitude / Longitude)</label>
                                <div class="mt-1 flex space-x-2">
                                    <input type="text" id="location-lat" placeholder="緯度" readonly class="block w-1/2 rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-600 dark:text-white shadow-sm sm:text-sm cursor-not-allowed">
                                    <input type="text" id="location-lng" placeholder="經度" readonly class="block w-1/2 rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-600 dark:text-white shadow-sm sm:text-sm cursor-not-allowed">
                                </div>
                            </div>
                            <button data-i18n="GET_LOCATION_BTN" id="get-location-btn" class="w-full py-2 px-4 rounded-lg font-bold btn-secondary">取得當前位置</button>
                            <button data-i18n="ADD_LOCATION_BTN" id="add-location-btn" class="w-full py-2 px-4 rounded-lg font-bold btn-primary" disabled>新增地點</button>
                        </div>
                    </div>
                    <div class="card p-6 mt-6">
                        <h2 data-i18n="API_TEST_TITLE" class="text-xl font-bold text-gray-800 dark:text-white mb-2">API 測試區</h2>
                        <p data-i18n="API_TEST_DESCRIPTION" class="text-gray-500 dark:text-gray-400 mb-4">點擊下方按鈕以測試新的 API 功能。</p>
                        <div>
                            <button data-i18n="API_TEST_BTN" id="test-api-btn" class="w-full py-2 px-4 rounded-lg font-bold btn-primary">測試 API</button>
                        </div>
                    </div>
                    
                </section>
            </div>
            <footer class="mt-8 text-center text-sm text-gray-500 dark:text-gray-400">
                <p>
                    <span data-i18n="APP_TITLE">打卡救星</span> v3.0 |
                    <span class="text-gray-400 dark:text-gray-500">
                        <span data-i18n="FOOTER_CREDITS_PREFIX">由</span>
                        <a href="https://github.com/0rigind1865-bit/Attendance-System" class="hover:underline hover:text-indigo-600 dark:hover:text-indigo-400">0J</a>
                        <span data-i18n="FOOTER_CREDITS_SUFFIX">製作</span>
                    </span>
                </p>
            </footer>
        </div>
        
        <!-- Notification -->
        <div id="notification" class="notification">
            <p id="notification-message"></p>
        </div>
        
        <script src="config.js"></script>
        <script src="script.js"></script>
        <!-- 👇 加班與請假功能 -->
        <script src="overtime.js"></script>
        <script src="leave.js"></script>
    </body>
</html>