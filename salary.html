<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>薪資管理系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style-redesign.css">
    <style>
        /* 薪資系統專屬樣式 */
        .salary-card-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .metric-card {
            position: relative;
            overflow: hidden;
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .dark .metric-card {
            background: #1e293b;
            border-color: #334155;
        }
        
        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(102,126,234,0.1) 0%, transparent 70%);
        }
        
        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(102, 126, 234, 0.15);
        }
        
        .amount-display {
            font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }
        
        .detail-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
        }
        
        .dark .detail-section {
            background: #0f172a;
            border-color: #334155;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            transition: all 0.2s;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-row:hover {
            background: rgba(102,126,234,0.05);
            padding-left: 0.5rem;
            padding-right: 0.5rem;
            border-radius: 0.5rem;
        }
        
        .dark .detail-row {
            border-bottom-color: rgba(255,255,255,0.05);
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .section-header::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .status-calculated {
            background: linear-gradient(135deg, #4facfe15 0%, #00f2fe15 100%);
            color: #0891b2;
            border: 1px solid #06b6d420;
        }
        
        .status-paid {
            background: linear-gradient(135deg, #11998e15 0%, #38ef7d15 100%);
            color: #059669;
            border: 1px solid #10b98120;
        }
        
        .history-item {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            border: 1px solid #e2e8f0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .dark .history-item {
            background: #1e293b;
            border-color: #334155;
        }
        
        .history-item:hover {
            transform: translateX(8px);
            box-shadow: 0 10px 20px rgba(102,126,234,0.15);
            border-color: #667eea;
        }
        
        .form-section {
            background: linear-gradient(135deg, #667eea05 0%, #764ba205 100%);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid rgba(102,126,234,0.1);
        }
        
        .input-group {
            margin-bottom: 1.5rem;
        }
        
        .input-label {
            display: block;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .dark .input-label {
            color: #cbd5e1;
        }
        
        .bank-info-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
            border-radius: 8px;
            border: 1px solid rgba(102,126,234,0.2);
            font-size: 0.875rem;
        }
        
        /* 修復紅色金額顯示 */
        .amount-display.text-red-500 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }
        
        /* 修復白色金額顯示 */
        .amount-display.text-white {
            background: none;
            -webkit-background-clip: unset;
            -webkit-text-fill-color: white;
            background-clip: unset;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900">
    <!-- 薪資管理分頁內容 -->
    <section id="salary-view" class="container mx-auto p-4 max-w-7xl">
        
        <!-- 一般員工：我的薪資 -->
        <div id="employee-salary-section" class="space-y-6">
            
            <!-- 本月薪資卡片 -->
            <div class="card p-8">
                <div class="section-header">
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">
                        本月薪資
                    </h2>
                </div>
                
                <div id="current-salary-loading" class="text-center py-12">
                    <div class="loading-spinner mx-auto mb-4"></div>
                    <p class="text-gray-600 dark:text-gray-400">載入中...</p>
                </div>
                
                <div id="current-salary-empty" class="text-center py-12 text-gray-500" style="display: none;">
                    <div class="text-6xl mb-4 opacity-20">₪</div>
                    <p class="text-lg font-medium">本月薪資尚未計算</p>
                    <p class="text-sm mt-2">請聯繫管理員進行薪資計算</p>
                </div>
                
                <div id="current-salary-content" style="display: none;">
                    <!-- 薪資概覽 -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                                應發總額
                            </div>
                            <div class="amount-display" id="gross-salary">--</div>
                        </div>
                        <div class="metric-card">
                            <div class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                                扣款總額
                            </div>
                            <div class="amount-display text-red-500" id="total-deductions">--</div>
                        </div>
                        <div class="metric-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
                            <div class="text-sm font-semibold text-white uppercase tracking-wider mb-2">
                                實發金額
                            </div>
                            <div class="amount-display text-white" id="net-salary">--</div>
                        </div>
                    </div>
                    
                    <!-- 詳細資訊 -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- 應發項目 -->
                        <div class="detail-section">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">應發項目</h3>
                            <div class="space-y-1">
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">基本薪資</span>
                                    <span id="detail-base-salary" class="font-mono font-semibold text-gray-800 dark:text-white">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">平日加班費</span>
                                    <span id="detail-weekday-overtime" class="font-mono font-semibold text-gray-800 dark:text-white">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">休息日加班費</span>
                                    <span id="detail-restday-overtime" class="font-mono font-semibold text-gray-800 dark:text-white">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">國定假日加班費</span>
                                    <span id="detail-holiday-overtime" class="font-mono font-semibold text-gray-800 dark:text-white">--</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 扣款項目 -->
                        <div class="detail-section">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">扣款項目</h3>
                            <div class="space-y-1">
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">勞保費</span>
                                    <span id="detail-labor-fee" class="font-mono font-semibold text-red-600 dark:text-red-400">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">健保費</span>
                                    <span id="detail-health-fee" class="font-mono font-semibold text-red-600 dark:text-red-400">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">就業保險費</span>
                                    <span id="detail-employment-fee" class="font-mono font-semibold text-red-600 dark:text-red-400">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">勞退自提</span>
                                    <span id="detail-pension-self" class="font-mono font-semibold text-red-600 dark:text-red-400">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">所得稅</span>
                                    <span id="detail-income-tax" class="font-mono font-semibold text-red-600 dark:text-red-400">--</span>
                                </div>
                                <div class="detail-row">
                                    <span class="text-gray-600 dark:text-gray-400">請假扣款</span>
                                    <span id="detail-leave-deduction" class="font-mono font-semibold text-red-600 dark:text-red-400">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 銀行資訊 -->
                    <div class="mt-6 detail-section">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">匯款資訊</h3>
                        <div class="flex flex-wrap gap-4">
                            <div class="bank-info-badge">
                                <span class="text-gray-600 dark:text-gray-400">銀行</span>
                                <span id="detail-bank-name" class="font-semibold text-gray-800 dark:text-white">--</span>
                            </div>
                            <div class="bank-info-badge">
                                <span class="text-gray-600 dark:text-gray-400">帳號</span>
                                <span id="detail-bank-account" class="font-mono font-semibold text-gray-800 dark:text-white">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 薪資歷史 -->
            <div class="card p-8">
                <div class="section-header">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">
                        薪資歷史
                    </h2>
                </div>
                
                <div id="salary-history-loading" class="text-center py-8">
                    <div class="loading-spinner mx-auto mb-4"></div>
                    <p class="text-gray-600 dark:text-gray-400">載入中...</p>
                </div>
                
                <div id="salary-history-empty" class="text-center py-12 text-gray-500" style="display: none;">
                    <div class="text-6xl mb-4 opacity-20">📊</div>
                    <p class="text-lg font-medium">尚無歷史記錄</p>
                </div>
                
                <div id="salary-history-list" class="space-y-3"></div>
            </div>
        </div>
        
        <!-- 管理員：薪資管理 -->
        <div id="admin-salary-section" class="space-y-6" style="display: none;">
            
            <!-- 員工薪資設定 -->
            <div class="card p-8">
                <div class="section-header">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">
                        員工薪資設定
                    </h2>
                </div>
                
                <form id="salary-config-form" class="form-section">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="input-group">
                            <label class="input-label">員工ID *</label>
                            <input type="text" id="config-employee-id" required 
                                class="form-input" placeholder="請輸入員工ID">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">員工姓名 *</label>
                            <input type="text" id="config-employee-name" required 
                                class="form-input" placeholder="請輸入員工姓名">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">身分證字號</label>
                            <input type="text" id="config-id-number" 
                                class="form-input" placeholder="A123456789">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">員工類型 *</label>
                            <select id="config-employee-type" required class="form-select">
                                <option value="正職">正職</option>
                                <option value="約聘">約聘</option>
                                <option value="工讀">工讀</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">薪資類型 *</label>
                            <select id="config-salary-type" required class="form-select">
                                <option value="月薪">月薪制</option>
                                <option value="時薪">時薪制</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">基本薪資 *</label>
                            <input type="number" id="config-base-salary" required 
                                class="form-input" placeholder="27470" min="183">
                            <small class="text-xs text-gray-500 mt-1 block">月薪最低27,470元 / 時薪最低183元</small>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">銀行代碼 *</label>
                            <select id="config-bank-code" required class="form-select">
                                <option value="">請選擇銀行</option>
                                <option value="004">004 - 臺灣銀行</option>
                                <option value="005">005 - 臺灣土地銀行</option>
                                <option value="006">006 - 合作金庫</option>
                                <option value="007">007 - 第一銀行</option>
                                <option value="008">008 - 華南銀行</option>
                                <option value="009">009 - 彰化銀行</option>
                                <option value="012">012 - 台北富邦</option>
                                <option value="013">013 - 國泰世華</option>
                                <option value="017">017 - 兆豐銀行</option>
                                <option value="803">803 - 聯邦銀行</option>
                                <option value="806">806 - 元大銀行</option>
                                <option value="807">807 - 永豐銀行</option>
                                <option value="808">808 - 玉山銀行</option>
                                <option value="809">809 - 凱基銀行</option>
                                <option value="812">812 - 台新銀行</option>
                                <option value="822">822 - 中國信託</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">銀行帳號 *</label>
                            <input type="text" id="config-bank-account" required 
                                class="form-input" placeholder="請輸入銀行帳號">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">到職日期</label>
                            <input type="date" id="config-hire-date" class="form-input">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">發薪日</label>
                            <input type="number" id="config-payment-day" 
                                class="form-input" value="5" min="1" max="31">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">勞退自提率 (%)</label>
                            <input type="number" id="config-pension-rate" 
                                class="form-input" value="0" min="0" max="6" step="0.1">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">勞保費（個人負擔）</label>
                            <input type="number" id="config-labor-fee" 
                                class="form-input" value="0" placeholder="0">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">健保費（個人負擔）</label>
                            <input type="number" id="config-health-fee" 
                                class="form-input" value="0" placeholder="0">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">就業保險費</label>
                            <input type="number" id="config-employment-fee" 
                                class="form-input" value="0" placeholder="0">
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">所得稅</label>
                            <input type="number" id="config-income-tax" 
                                class="form-input" value="0" placeholder="0">
                        </div>
                    </div>
                    
                    <div class="input-group mt-6">
                        <label class="input-label">備註</label>
                        <textarea id="config-note" rows="2" 
                            class="form-textarea" placeholder="其他說明事項"></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-full mt-6">
                        儲存薪資設定
                    </button>
                </form>
            </div>
            
            <!-- 薪資計算 -->
            <div class="card p-8">
                <div class="section-header">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">
                        薪資計算
                    </h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="input-group">
                        <label class="input-label">員工ID</label>
                        <input type="text" id="calc-employee-id" 
                            class="form-input" placeholder="請輸入員工ID">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">計算月份</label>
                        <input type="month" id="calc-year-month" class="form-input">
                    </div>
                    
                    <div class="flex items-end">
                        <button id="calculate-salary-btn" class="btn btn-primary w-full">
                            開始計算
                        </button>
                    </div>
                </div>
                
                <div id="salary-calculation-result" class="space-y-4" style="display: none;">
                    <!-- 計算結果會動態顯示在這裡 -->
                </div>
            </div>
            
            <!-- 所有員工薪資列表 -->
            <div class="card p-8">
                <div class="section-header">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">
                        所有員工薪資
                    </h2>
                </div>
                
                <div class="mb-6 max-w-md">
                    <label class="input-label">查詢月份</label>
                    <input type="month" id="filter-year-month" class="form-input">
                </div>
                
                <div id="all-salary-loading" class="text-center py-8">
                    <div class="loading-spinner mx-auto mb-4"></div>
                    <p class="text-gray-600 dark:text-gray-400">載入中...</p>
                </div>
                
                <div id="all-salary-list" class="space-y-3"></div>
            </div>
        </div>
    </section>
    
    <!-- Notification -->
    <div id="notification" class="notification">
        <p id="notification-message"></p>
    </div>
    
    <script src="config.js"></script>
    <script src="salary.js"></script>
</body>
</html>